<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>νν‹° μ†κ°</title>
<link rel="stylesheet" href="/css/party.css">
</head>
<body>
	<th:block th:include="common/header"></th:block>
	<main class="content">
		<div class="container">
			<div class="title">νν‹° μ†κ°</div>

			<!-- νƒ­ -->
			<div class="tabs">
				<div class="active">μ™€μΈ νν‹° π·</div>
				<div>λΉ„μ–΄ νν‹° πΊ</div>
			</div>

		
			<div class="tab-content">
				<!-- μ™€μΈ νν‹° -->
				<div class="party-tab active" data-party="wine">
					<div class="party-img">
						<div class="arrow left">&lt;</div>
						<th:block th:each="party,iterStat : ${parties}"
							th:if="${party.partyType.toLowerCase() == 'wine'}">
							<img th:src="@{/partyImg/{thumb}(thumb=${party.partyThumb})}"
								th:data-date="${party.partyDate}"
								th:data-place="${party.partyPlace}"
								th:data-price="${party.partyPrice}"
								th:classappend="${iterStat.index == 0} ? 'active' : ''"
								th:alt="${party.partyTitle}">
						</th:block>
						<div class="arrow right">&gt;</div>
					</div>

					<div class="info">
						<div class="info-row">
							<span>μΌμ‹</span> <span id="wine-date"></span>
						</div>
						<div class="info-row">
							<span>μ¥μ†</span> <span id="wine-place"></span>
						</div>
						<div class="info-row">
							<span>κ°€κ²©</span> <span id="wine-price"></span>
						</div>
					</div>
				</div>

				<!-- λΉ„μ–΄ νν‹° -->
				<div class="party-tab" data-party="beer">
					<div class="party-img">
						<div class="arrow left">&lt;</div>
						<th:block th:each="party,iterStat : ${parties}"
							th:if="${party.partyType.toLowerCase() == 'beer'}">
							<img th:src="@{/partyImg/{thumb}(thumb=${party.partyThumb})}"
								th:data-date="${party.partyDate}"
								th:data-place="${party.partyPlace}"
								th:data-price="${party.partyPrice}"
								th:classappend="${iterStat.index == 0} ? 'active' : ''"
								th:alt="${party.partyTitle}">
						</th:block>
						<div class="arrow right">&gt;</div>
					</div>

					<div class="info">
						<div class="info-row">
							<span>μΌμ‹</span> <span id="beer-date"></span>
						</div>
						<div class="info-row">
							<span>μ¥μ†</span> <span id="beer-place"></span>
						</div>
						<div class="info-row">
							<span>κ°€κ²©</span> <span id="beer-price"></span>
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>

	<th:block th:include="common/footer"></th:block>

	<script>
	const tabs = document.querySelectorAll(".tabs div");
	const partyTabs = document.querySelectorAll(".party-tab");

	tabs.forEach((tab, i) => {
		tab.addEventListener("click", () => {
			tabs.forEach(t => t.classList.remove("active"));
			partyTabs.forEach(pt => pt.classList.remove("active"));
			tab.classList.add("active");
			partyTabs[i].classList.add("active");
		});
	});

	partyTabs.forEach(tab => {
		const imgs = tab.querySelectorAll("img");
		const left = tab.querySelector(".arrow.left");
		const right = tab.querySelector(".arrow.right");
		let cur = 0;

		function showImg(index) {
			if(imgs.length === 0) return;
			imgs.forEach(img => img.classList.remove("active"));
			const img = imgs[index];
			img.classList.add("active");

			const type = tab.dataset.party;

			// λ‚ μ§ YYYY-MM-DD HH:MM
			const dateObj = new Date(img.dataset.date);
			const year = dateObj.getFullYear();
			const month = (dateObj.getMonth()+1).toString().padStart(2,'0');
			const day = dateObj.getDate().toString().padStart(2,'0');
			const hours = dateObj.getHours().toString().padStart(2,'0');
			const minutes = dateObj.getMinutes().toString().padStart(2,'0');
			tab.querySelector(`#${type}-date`).textContent = `${year}-${month}-${day} ${hours}:${minutes}`;

			tab.querySelector(`#${type}-place`).textContent = img.dataset.place;

			const price = Number(img.dataset.price).toLocaleString();
			tab.querySelector(`#${type}-price`).textContent = price + "μ›";
		}

		if(left && right){
			left.addEventListener("click", () => {
				cur = (cur - 1 + imgs.length) % imgs.length;
				showImg(cur);
			});
			right.addEventListener("click", () => {
				cur = (cur + 1) % imgs.length;
				showImg(cur);
			});
		}

		showImg(cur);
	});
	</script>
</body>
</html>
