<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>파티 소개</title>
<link rel="stylesheet" href="/css/party.css">
</head>
<body>
	<th:block th:include="common/header"></th:block>
	<main class="content">
		<div class="container">
			<div class="title">파티 소개</div>
			<div class="tabs">
				<div class="active">와인 파티 🍷</div>
				<div>비어 파티 🍺</div>
			</div>
			<div class="tab-content">
				<div class="party-tab active" data-party="wine">
					<div class="party-img">
						<div class="arrow left" onclick="prevImg('wine')">&lt;</div>
						<th:block th:each="party,iterStat : ${parties}"
							th:if="${party.partyType.toLowerCase() == 'wine'}">
							<img th:src="@{/partyImg/{thumb}(thumb=${party.partyThumb})}"
								th:data-date="${party.partyDate}"
								th:data-place="${party.partyPlace}"
								th:data-price="${party.partyPrice}"
								th:data-partyno="${party.partyNo}"
								th:classappend="${iterStat.index == 0} ? 'active' : ''"
								th:alt="${party.partyTitle}">
						</th:block>
						<div class="arrow right" onclick="nextImg('wine')">&gt;</div>
					</div>
					<div class="info">
						<div class="info-row">
							<span>일시</span> <span id="wine-date"></span>
						</div>
						<div class="info-row">
							<span>장소</span> <span id="wine-place"></span>
						</div>
						<div class="info-row">
							<span>가격</span> <span id="wine-price"></span>
						</div>
					</div>
				</div>
				<div class="party-tab" data-party="beer">
					<div class="party-img">
						<div class="arrow left" onclick="prevImg('beer')">&lt;</div>
						<th:block th:each="party,iterStat : ${parties}"
							th:if="${party.partyType.toLowerCase() == 'beer'}">
							<img th:src="@{/partyImg/{thumb}(thumb=${party.partyThumb})}"
								th:data-date="${party.partyDate}"
								th:data-place="${party.partyPlace}"
								th:data-price="${party.partyPrice}"
								th:data-partyno="${party.partyNo}"
								th:classappend="${iterStat.index == 0} ? 'active' : ''"
								th:alt="${party.partyTitle}">
						</th:block>
						<div class="arrow right" onclick="nextImg('beer')">&gt;</div>
					</div>
					<div class="info">
						<div class="info-row">
							<span>일시</span> <span id="beer-date"></span>
						</div>
						<div class="info-row">
							<span>장소</span> <span id="beer-place"></span>
						</div>
						<div class="info-row">
							<span>가격</span> <span id="beer-price"></span>
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>
	<th:block th:include="common/footer"></th:block>
	<script>
const tabs = document.querySelectorAll(".tabs div");
const partyTabs = document.querySelectorAll(".party-tab");
tabs.forEach((tab, i) => {
    tab.addEventListener("click", () => {
        tabs.forEach(t => t.classList.remove("active"));
        partyTabs.forEach(pt => pt.classList.remove("active"));
        tab.classList.add("active");
        partyTabs[i].classList.add("active");
    });
});

let currentIndex = {
    wine: 0,
    beer: 0
};

function showImg(type, index) {
    const tab = document.querySelector(`.party-tab[data-party="${type}"]`);
    const imgs = tab.querySelectorAll("img");
    if (imgs.length === 0) return;
    imgs.forEach(img => img.classList.remove("active"));
    const img = imgs[index];
    img.classList.add("active");
    tab.querySelector(`#${type}-date`).textContent = img.dataset.date;
    tab.querySelector(`#${type}-place`).textContent = img.dataset.place;
    tab.querySelector(`#${type}-price`).textContent = img.dataset.price + "원";
    img.onclick = function() {
        const partyNo = img.dataset.partyno;
        location.href = '/party/user?partyNo=' + partyNo;
    };
}

function prevImg(type) {
    const tab = document.querySelector(`.party-tab[data-party="${type}"]`);
    const imgs = tab.querySelectorAll("img");
    if (imgs.length === 0) return;
    currentIndex[type] = (currentIndex[type] - 1 + imgs.length) % imgs.length;
    showImg(type, currentIndex[type]);
}

function nextImg(type) {
    const tab = document.querySelector(`.party-tab[data-party="${type}"]`);
    const imgs = tab.querySelectorAll("img");
    if (imgs.length === 0) return;
    currentIndex[type] = (currentIndex[type] + 1) % imgs.length;
    showImg(type, currentIndex[type]);
}

showImg("wine", 0);
showImg("beer", 0);
</script>
</body>
</html>
