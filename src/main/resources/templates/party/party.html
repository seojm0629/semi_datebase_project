<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>파티 소개</title>
<link rel="stylesheet" href="/css/party.css">
</head>
<body>
	<th:block th:include="common/header"></th:block>
	<div class="container">
		<div class="title">파티 소개</div>

		<!-- 탭 -->
		<div class="tabs">
			<div class="active">와인 파티 🍷</div>
			<div>비어 파티 🍺</div>
		</div>

		<!-- 탭별 콘텐츠 -->
		<div class="tab-content">
			<!-- 와인 파티 -->
			<div class="party-tab active" data-party="wine">
				<div class="party-img">
					<div class="arrow left">&lt;</div>
					<th:block th:each="party,iterStat : ${parties}"
						th:if="${party.partyType.toLowerCase() == 'wine'}">
						<img th:src="@{/image/{thumb}(thumb=${party.partyThumb})}"
							th:data-date="${party.partyDate}"
							th:data-place="${party.partyPlace}"
							th:data-price="${party.partyPrice}"
							th:classappend="${iterStat.index == 0} ? 'active' : ''"
							th:alt="${party.partyTitle}">
					</th:block>
					<div class="arrow right">&gt;</div>
				</div>
				<!-- info는 하나만 두고 JS로 바꿔줌 -->
				<div class="info">
					<div class="info-row">
						<span>일시</span> <span id="wine-date"></span>
					</div>
					<div class="info-row">
						<span>장소</span> <span id="wine-place"></span>
					</div>
					<div class="info-row">
						<span>가격</span> <span id="wine-price"></span>
					</div>
				</div>
			</div>

			<!-- 비어 파티 -->
			<div class="party-tab" data-party="beer">
				<div class="party-img">
					<div class="arrow left">&lt;</div>
					<th:block th:each="party,iterStat : ${parties}"
						th:if="${party.partyType.toLowerCase() == 'beer'}">
						<img th:src="@{/image/{thumb}(thumb=${party.partyThumb})}"
							th:data-date="${party.partyDate}"
							th:data-place="${party.partyPlace}"
							th:data-price="${party.partyPrice}"
							th:classappend="${iterStat.index == 0} ? 'active' : ''"
							th:alt="${party.partyTitle}">
					</th:block>
					<div class="arrow right">&gt;</div>
				</div>
				<div class="info">
					<div class="info-row">
						<span>일시</span> <span id="beer-date"></span>
					</div>
					<div class="info-row">
						<span>장소</span> <span id="beer-place"></span>
					</div>
					<div class="info-row">
						<span>가격</span> <span id="beer-price"></span>
					</div>
				</div>
			</div>
		</div>
	</div>

	<th:block th:include="common/footer"></th:block>

	<script>
		// 탭 전환
		const tabs = document.querySelectorAll(".tabs div");
		const partyTabs = document.querySelectorAll(".party-tab");

		tabs.forEach((tab, i) => {
			tab.addEventListener("click", () => {
				tabs.forEach(t => t.classList.remove("active"));
				partyTabs.forEach(pt => pt.classList.remove("active"));
				tab.classList.add("active");
				partyTabs[i].classList.add("active");
			});
		});

		// 이미지 + 정보 연동 슬라이드
		partyTabs.forEach(tab => {
			const imgs = tab.querySelectorAll("img");
			const left = tab.querySelector(".arrow.left");
			const right = tab.querySelector(".arrow.right");
			let cur = 0;

			function showImg(index) {
				imgs.forEach(img => img.classList.remove("active"));
				if (imgs[index]) {
					imgs[index].classList.add("active");
					// info 갱신
					const type = tab.dataset.party;
					tab.querySelector(`#${type}-date`).textContent = imgs[index].dataset.date;
					tab.querySelector(`#${type}-place`).textContent = imgs[index].dataset.place;
					tab.querySelector(`#${type}-price`).textContent = imgs[index].dataset.price + "원";
				}
			}

			if(left && right) {
				left.addEventListener("click", () => {
					cur = (cur - 1 + imgs.length) % imgs.length;
					showImg(cur);
				});

				right.addEventListener("click", () => {
					cur = (cur + 1) % imgs.length;
					showImg(cur);
				});
			}

			// 초기 세팅
			showImg(cur);
		});
	</script>
</body>
</html>
