<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
<meta charset="UTF-8">
<title>파티 관리</title>
<style>
* {
	margin: 0;
	padding: 0;
	box-sizing: border-box;
	color: #2B2B2B;
}

body {
	background: #fff;
	margin: 0 auto;
}

.page-title {
	text-align: center;
	font-size: 28px;
	font-weight: bold;
	margin: 40px 0 30px;
	color: #A66E33;
}

.tab {
	display: flex;
	justify-content: center;
	gap: 300px;
	margin-bottom: 20px;
	font-size: 18px;
	font-weight: 600;
}

.tab-btn {
	font-size: 20px;
	font-weight: bold;
	border-bottom: 2px solid transparent;
	color: #2B2B2B;
	padding-bottom: 5px;
	cursor: pointer;
}

.tab-btn.active {
	color: #A66E33;
	border-bottom: 1px solid #A66E33;
}

.party-box {
	border: 2px solid #ddd;
	padding: 20px;
	margin-bottom: 20px;
	width: 1200px;
	margin: 0 auto;
}

table {
	width: 100%;
	border-collapse: collapse;
	text-align: center;
	font-size: 16px;
}

th, td {
	border: 1px solid #ccc;
	padding: 12px;
}

th {
	background: #f7f7f7;
}

td {
	background: #fff;
}

.btn-write {
	display: block;
	width: 200px;
	margin: 30px auto 50px;
	padding: 12px;
	text-align: center;
	background: #e3e3e3;
	border: none;
	cursor: pointer;
	font-size: 16px;
	font-weight: bold;
}

.btn-write:hover {
	background: #d3d3d3;
}
</style>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>

	<th:block th:include="common/header"></th:block>

	<h1 class="page-title">파티 관리</h1>

	<div class="tab">
		<span class="tab-btn active" data-type="wine">와인 파티 🍷</span> <span
			class="tab-btn" data-type="beer">비어 파티 🍺</span>
	</div>

	<div class="party-box">
		<table>
			<thead>
				<tr>
					<th>파티 일자</th>
					<th>파티 장소</th>
					<th>인원 현황</th>
				</tr>
			</thead>
			<tbody id="party-table-body">
			</tbody>
		</table>
	</div>

	<
	<button class="btn-write">파티 게시글 작성</button>

	<script>
$(document).ready(function(){

    function loadParty(type){
        $.ajax({
            url: '/party/admin/list',
            type: 'GET',
            data: { type: type },
            success: function(list){
                let tbody = $("#party-table-body");
                tbody.empty();
                
                if(list.length === 0){
                    tbody.append('<tr><td colspan="3">등록된 파티가 없습니다.</td></tr>');
                } else {
                    list.forEach(function(p){
                        tbody.append(
                            `<tr>
                                <td>${p.partyDate}</td>
                                <td>${p.partyPlace}</td>
                                <td>남 ${p.partyMale}명 / 여 ${p.partyFemale}명</td>
                            </tr>`
                        );
                    });
                }
            },
            error: function(xhr, status, error){
                console.error("AJAX Error:", xhr.status, error);
                $("#party-table-body").html('<tr><td colspan="3">데이터를 불러오는데 실패했습니다.</td></tr>');
            }
        });
    }

    loadParty('wine');

    $(".tab-btn").click(function(){
        $(".tab-btn").removeClass("active"); 
        $(this).addClass("active");          
        let type = $(this).data("type");
        loadParty(type);
    });

    $(".btn-write").click(function(){
        window.location.href = "/party/new";
    });

});
</script>

	<th:block th:include="common/footer"></th:block>
</body>
</html>
