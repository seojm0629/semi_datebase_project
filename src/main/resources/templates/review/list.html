<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<style>
@font-face {
    font-family: main2;
    src: url(../CSS/font/PyeongChang-Regular.ttf);
}
@font-face {
    font-family: mainB2;
    src: url(../CSS/font/PyeongChang-Bold.ttf);
}
:root{
    --color1 : #2B2B2B;/*검은 글씨색*/
    --color2 : #FAF8F1;/*푸터 배경색*/
    --color3 : #FAEAB1;/**/
    --color4 : #E5BA73;/*버튼색, 로고, 페이지 제목*/
    --color5 : #C58940;/*푸터 두꺼운 글씨, 선 그을때*/
    --color6 : #EAC88F;/*버튼 호버한 경우 색*/
    --color7 : #FF6868;/*경고색*/
    --color8 : #D9D9D9;/*취소버튼*/
}

*{
    margin: 0px;
    padding: 0px;
    color: #2B2B2B;
    font-family: mainB2;
}

.review-content{
    width: 900px;
    margin: 0 auto;    
}
.review-title{
    margin: 25px auto;
    text-align: center;
    margin-bottom: 80px;
}

.review-title>h2{
	color: #E5BA73;
	font-family: mainB2;
	font-weight: 800;
	font-size: 28px;
}

.party-blind{
    width: 450px;
    display: flex;
    margin: 0 auto;
    text-align: center;
}
.party-blind>.party{
    margin-right: 70px;
}
.party-blind>div{
    font-size: 25px;
    width: 200px;
    height: 100px;
    line-height: 100px;
    border: 1px solid black;
    border-radius: 15px;
    background-color: #E5BA73;
    cursor: pointer;
}

.review-board{
    display: flex;
}
.review-board>div:first-child{
    padding-right: 20px;
}

.party-blind>div{
	font-weight: 800;
	
}

.party-tab-review{
	width: 900px;
    height: 600px;
    line-height: 600px;
    background-color: #ffffff;
    border: 1px solid black;
}

.party-tab-review{
    text-align: center;
}

.party-blind>.active-tab{
	background-color: #C58940;
	color: #ffffff;
	font-weight: 900;
}
.party-tab-review>div{
	display:none;
	
}
.party-tab-review>.active-content{
	display:block;
	width: 900px;
    height: 600px;
    line-height: 600px;
    background-color: #ffffff;
    border: 1px solid black;
}
/*사진게시판*/
.posting-wrap{
	overflow: hidden;
	padding: 10px;
}
.posting-wrap>.posting-item{
	box-sizing: border-box;
	width : calc(100% / 3);
	float: left;
	padding : 30px	
}
.posting-img{
	height: 200px;
}
.posting-img>img{
	width:100%;
	height:100%;
	object-fit:contain;
}


</style>
</head>
<body>
	<th:block th:include="common/header"></th:block>

        <div class="review-content">
            <div class="review-title">
                <h2>DateBase 이용 후기</h2>
            </div>
            
	        <div th:if="${session.member != null}">
	          	<a href="/review/writeFrm" class="write-btn">글쓰기</a>
	        </div>

            <div class="party-blind">
                <div class="party">파티 후기</div>
                <div class="blind">소개팅 후기</div>
            </div>

            <div class="review-board">
                <div>게시판</div>
                <div>게시판 수</div>
            </div>
            
            <ul class="reviewWrapper posting-wrap">
            
            </ul>

			<div class="party-tab-review">
				<div class="party-review">
					<button class="btn-point" id="party-more-btn">더보기</button>
				</div>
				<div>blind</div>
			</div>
            

        </div>
	
	<th:block th:include="common/footer"></th:block>
	<script th:inline="javascript">
		const tabMenu = $(".party-blind>div");
		const tabContent = $(".party-tab-review>div");
	
		tabMenu.on("click", function(){
			tabMenu.removeClass("active-tab");
			tabContent.hide();
			$(this).addClass("active-tab");
			const i = tabMenu.index(this);
			tabContent.eq(i).show();
		});
		tabMenu.eq(0).click();
		
		/*파티 후기*/
		const totalCount = [[${partyTotalCount}]];	//페이지 들어올 때 조회해온 전체 게시물 수
		let currentCount = 0;					//현재까지 읽어온 게시물 수를 저장
		let start = 1;							//추가로 가져올 게시물의 시작번호
		const amount = 3;						//더보기 한번 클릭 시 추가로 가져올 게시물 수
	
		$("#party-more-btn").on("click", function(){
			$.ajax({
				url: "/review/more",
				type: "get",
				data: {start : start, amount: amount},
				success: function(data){
					
				for(let i=0; i<data.length;i++){
					const r = data[i];
					
					const li = $("<li>");
					li.addClass("posting-item");
					const imgDiv = $("<div>");
					imgDiv.addClass("posting-img");
					const img = $("<img>")
					img.attr("src", "/review_party/image/"+r.reviewImg)
					
					imgDiv.append(img);
					
					const infoDiv = $("<div>");
					infoDiv.addClass("posting-info");
					const titleDiv = $("<div>");
					titleDiv.addClass("postion-title");
					titleDiv.text(r.reviewTitle);
					const subDiv = $("<div>");
					subDiv.addClass("posting-sub-info");
					const span = $("<span>");
					span.text(r.reviewWriter);
					
					subDiv.append(span);
					infoDiv.append(titleDiv).append(subDiv);
					
					li.append(imgDiv).append(infoDiv);
					$(".reviewWrapper").append(li);
				}
				//화면에 요소 추가 끝
				
				//더보기를 누르면 그 이후 데이터를 가져오기 위한 설정
				start = start + amount;
				
				//현재까지 읽어온 게시물 수 변경
				currentCount = currentCount + data.length; 
				//전체 게시물 수와 읽어온 게시물 수가 같으면 -> 더이상 읽어올 데이터가 없음
				if(currentCount === partyTotalCount){
					$("#party-more-btn").remove();
				}
			},	
			error: function(){
				console.log("에러");
			}
			});
		});
	</script>
</body>
</html>











































